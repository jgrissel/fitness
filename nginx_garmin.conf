server {
    listen 80;
    server_name garmin.yourdomain.com; # REPLACE THIS with your actual domain/subdomain

    # Dashboard (Streamlit)
    location / {
        proxy_pass http://localhost:8501;
        proxy_http_version 1.1;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $host;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_read_timeout 86400;
    }

    # API Endpoints
    location /api/ {
        # Note: You might want to access the API directly on port 8000 via a different subdomain
        # OR route it like this. If simple, maybe just use a separate subdomain api.garmin.yourdomain.com
        # But for simplicity, let's map /api -> localhost:8000
        rewrite ^/api/(.*) /$1 break;
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}

# ALTERNATIVE: Access API on a different port via Nginx?
# Actually, simpler for a "noob" setup might be to just use two subdomains:
# 1. dashboard.yourdomain.com -> 8501
# 2. api.yourdomain.com -> 8000
